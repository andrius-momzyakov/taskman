{% extends "base.html" %}

{% block title %}Описание задачи{% endblock %}
{% block content %}
<h1>{{ object.subject }}</h1>
<button onclick="parent.location='{% url 'edit' object.id %}'">Изменить</button>
<!--<a href="{% url 'edit' object.id %}">Изменить</a> -->
<hr>
<table class="detail">
    
<tr><td><div><b>Тип:</b></div></td><td><div>{{ object.type }}</div></div></td></tr>
<tr><td><div><b>Описание:</b></div></td><td><div><code><pre>{{ object.desc }}</pre></code></div></td></tr>
<tr><td><div><b>Создано:</b></div></td><td><div>{{ object.created|date:'d.m.Y H:i'|default_if_none:"" }}</div></td></tr>
<tr><td><div><b>Заявитель:</b></div></td><td><div>{{ object.created_by|default_if_none:"" }}</div></td></tr>
<tr><td><div><b>Исполнитель:</b></div></td><td><div>{{ object.executor|default_if_none:"" }}</div></td></tr>
<tr><td><div><b>Крайний срок:</b></div></td><td><div>{{ object.deadline_date|date:"d.m.Y H:i"|default_if_none:"" }}</div></td></tr>
<tr><td><div><b>Частная:</b></div></td><td><div>{{ object.get_private_literal}}</div></td></tr>
<tr><td><div><b>Проект:</b></div></td><td><div>{{ object.project|default_if_none:"" }}</div></td></tr>
<tr><td><div><b>Модуль:</b></div></td><td><div>{{ object.module|default_if_none:"" }}</div></td></tr>
<tr><td><div><b>Статус:</b></div></td><td><div>{{ object.get_status_literal|default_if_none:"" }}</div></td></tr>
<tr><td><div><b>Закрыто:</b></div></td><td><div>{{ object.closed|date:"d.m.Y H:i"|default_if_none:"" }}</div></td></tr>
{% if object.parent %}
<tr><td><div><b>Родительская задача:</b></div></td><td><div><a href="{% url 'detail' object.parent.id %}">{{ object.parent.subject }}</a></div></td></tr>
{% endif %}
    </table>

{% if children %}
<h2>Подзадачи</h2>
{% for child in children %}
<p><a href="/task/detail/{{ child.id }}/">{{ child }}</a> - [{{ child.get_status_literal }}]</p>
{% endfor%}
{% endif %}

{% if attachments %}
<h2>Присоединенные файлы:</h2>
{% endif %}
{% for attachment in attachments %}
<p><a href="{{ MEDIA_URL }}{{ attachment.file.name }}">{{ attachment.file.name }}</a></p>
{% endfor %}

{% if comments %}
<h2>Комментарии:</h2>
<table>
{% for comment in comments%}

    <tr class="detail">
        <td>{{ comment.author }}</td>
        <td>{{ comment.created|date:"d.m.Y" }}</td>
        <td><pre>{{ comment.body }}</pre></td>
</tr>
    {% endfor %}
</table>
    {% endif %}
{% endblock %}